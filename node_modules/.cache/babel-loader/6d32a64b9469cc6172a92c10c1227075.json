{"ast":null,"code":"import _classCallCheck from \"/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/src/pages/sales.js\";\nimport React, { Component } from \"react\";\nimport { Container, Row, Col // Table,\n, Button, Input // FormGroup,\n// Label\n} from \"reactstrap\";\nimport { Link } from \"react-router-dom\";\nimport CustomTable from \"../components/custom-table\";\nimport CustomDateRangePicker from \"../components/date-range-picker\";\nimport { // getAllCreators,\n// getAllSubscribers,\n// getAllTransactions,\n// updateTransactions,\ngetAllUsers, getAllPPVs, onUpdatePPVStatus, sendMessage } from \"../http/http-calls\";\nimport { ToastsStore } from \"react-toasts\";\nimport config from \"../config\";\nimport { format } from \"date-fns\";\nimport TextEditor from \"../components/text-editor\";\nimport moment from \"moment\";\nimport { showToast, deepClone } from \"../helper-methods\";\nimport CustomDataTable from \"../components/custom-data-table\";\n\nvar PayPerView = /*#__PURE__*/function (_Component) {\n  _inherits(PayPerView, _Component);\n\n  var _super = _createSuper(PayPerView);\n\n  function PayPerView() {\n    var _this;\n\n    _classCallCheck(this, PayPerView);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      ppvList: [{\n        orderid: \"\",\n        product: \"\",\n        price: 123,\n        salesamount: \"\",\n        created: \"\",\n        status: \"\"\n      }],\n      ppvListBackup: [],\n      creatorList: [],\n      subscriberList: [],\n      transactionList: [],\n      transactionListBackup: [],\n      paymentTypes: config.paymentTypes,\n      ppvStatusList: [\"published\", \"archived\", \"scheduled\"],\n      headerKeys: [{\n        id: \"id\",\n        label: \"id\"\n      }, {\n        id: \"orderid\",\n        label: \"Order Id\"\n      }, {\n        id: \"product\",\n        label: \"Product\"\n      }, {\n        id: \"price\",\n        label: \"Price\"\n      }, // { id: \"sales\", label: \"Sales\" },\n      {\n        id: \"salesamount\",\n        label: \"Sales Amount\"\n      }, {\n        id: \"created\",\n        label: \"Created\"\n      }, {\n        id: \"status\",\n        label: \"Status\"\n      }],\n      filters: {\n        dateRange: {\n          startDate: null,\n          endDate: null,\n          focusedInput: null,\n          startDateId: \"startDate\",\n          endDateId: \"endDate\"\n        },\n        viewCount: {\n          upper: \"\",\n          lower: \"\"\n        },\n        subscriber: \"\",\n        creator: \"\",\n        status: \"\",\n        search: \"\"\n      },\n      loading: {\n        loadingData: true,\n        changeStatusLoading: false,\n        tableLoading: false,\n        sendingMessage: false\n      },\n      contact: {\n        via: \"email\",\n        message: \"\"\n      },\n      selectedPPVs: [],\n      bulkStatus: \"\",\n      selectedTransactions: [],\n      totalCount: 0,\n      ppvFieldsKeyMap: {\n        name: \"ppv\",\n        fee: \"price\",\n        date: \"time\",\n        viewCount: \"viewCount\",\n        creatorName: \"_influencer\",\n        status: \"status\"\n      },\n      tableConfig: {\n        pageNumber: 1,\n        pageSize: 10,\n        sort: {\n          sortBy: \"time\",\n          sortOrder: \"desc\"\n        },\n        filters: {}\n      }\n    };\n\n    _this._getAllPPVs = function (data) {\n      var tableConfig = _this.state.tableConfig;\n      console.log(\"LiveEvents -> _getLiveEvents -> tableConfig\", data);\n      getAllPPVs(data).then(function (response) {\n        _this._manageLoading(\"data\", false);\n\n        tableConfig.loading = false;\n\n        _this.setState({\n          tableConfig: tableConfig\n        });\n\n        console.log(\"response >>\", response);\n        var ppvListResp = response.payperviews.map(function (each) {\n          return {\n            name: each.title,\n            creatorName: each._influencer.name.full,\n            id: each._id,\n            flag: each._influencer.address.country,\n            creatorId: each._influencer._id,\n            profilePicture: each._influencer.profilePicture || config.defaultUserPicture,\n            time: moment(each.scheduledAt).format(\"LLL\"),\n            status: each.status,\n            createdAt: each.createdAt,\n            viewer: each.viewCount ? each.viewCount : 0,\n            basicPrice: each.price ? each.price : 0,\n            premiumPrice: each.premiumPrice ? each.premiumPrice : 0,\n            plusPrice: each.plusPrice ? each.plusPrice : 0\n          };\n        });\n\n        _this.setState({\n          // ppvList: ppvListResp,\n          ppvListBackup: ppvListResp,\n          totalCount: response.count\n        });\n      }).catch(function (err) {});\n    };\n\n    _this._onDatesChange = function (startDate, endDate) {\n      // console.log(\"on date change\", startDate, endDate);\n      var filters = _this.state.filters;\n      filters.dateRange.startDate = startDate;\n      filters.dateRange.endDate = endDate;\n\n      _this.setState({\n        filters: filters\n      });\n\n      if (filters.dateRange.startDate && filters.dateRange.endDate) {\n        // console.log(\"range selction complete\");\n        // this._filterTransactionList();\n        _this._applyFilterChanges();\n      }\n    };\n\n    _this._onFocusChange = function (input) {\n      // console.log(input);\n      var filters = _this.state.filters;\n      filters.dateRange.focusedInput = input;\n\n      _this.setState({\n        filters: filters\n      });\n    };\n\n    _this._manageLoading = function (key, value) {\n      var _this$state$loading = _this.state.loading,\n          loadingData = _this$state$loading.loadingData,\n          changeStatusLoading = _this$state$loading.changeStatusLoading,\n          tableLoading = _this$state$loading.tableLoading,\n          sendingMessage = _this$state$loading.sendingMessage;\n\n      if (key === \"data\") {\n        loadingData = value;\n      } else if (key === \"change-status\") {\n        changeStatusLoading = value;\n      } else if (key === \"table\") {\n        tableLoading = value;\n      } else if (key === \"send-message\") {\n        sendingMessage = value;\n      }\n\n      _this.setState({\n        loading: {\n          loadingData: loadingData,\n          changeStatusLoading: changeStatusLoading,\n          tableLoading: tableLoading\n        }\n      });\n    };\n\n    _this._getAllUsers = function () {\n      getAllUsers().then(function (response) {\n        console.log(\"response :\", response);\n        var creatorList = response.influencers.map(function (each) {\n          return {\n            name: each.name.full,\n            id: each.id\n          };\n        });\n        creatorList = creatorList.sort(function (a, b) {\n          var textA = a.name.toLowerCase();\n          var textB = b.name.toLowerCase();\n          return textA < textB ? -1 : textA > textB ? 1 : 0;\n        });\n        var subscriberList = response.fans.map(function (each) {\n          return {\n            name: each.name.full,\n            id: each.id\n          };\n        });\n        subscriberList = subscriberList.sort(function (a, b) {\n          var textA = a.name.toLowerCase();\n          var textB = b.name.toLowerCase();\n          return textA < textB ? -1 : textA > textB ? 1 : 0;\n        });\n\n        _this.setState({\n          creatorList: creatorList,\n          subscriberList: subscriberList\n        });\n      }, function (error) {\n        console.log(\"error :\", error);\n        showToast(error.reason && error.reason.length ? error.reason : \"Server error. Try again after sometime.\", \"error\");\n      });\n    };\n\n    _this._dataFormat = function (cell, row, header) {\n      // console.log(\"_dataFormat -> row\", row);\n      // console.log(\"header\", header);\n      // console.log(cell, row, header);_formatDate\n      if (header === \"name\") {\n        return /*#__PURE__*/React.createElement(Link, {\n          to: \"/pay-per-view/\".concat(row.id),\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"capitalize\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 11\n          }\n        }, row.name));\n      } else if (header === \"amount\") {\n        return typeof cell === \"number\" ? \"$\" + cell.toFixed(2) : \"-\";\n      } else if (header === \"date\") {\n        return /*#__PURE__*/React.createElement(React.Fragment, null, row.time);\n      } else if (header === \"creatorName\") {\n        return /*#__PURE__*/React.createElement(Link, {\n          to: \"/creator-view/\".concat(row.creatorId),\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"img\", {\n          src: \"https://www.countryflags.io/\".concat(row.flag, \"/flat/24.png\"),\n          alt: \"flag\",\n          className: \"mr-2\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 11\n          }\n        }), /*#__PURE__*/React.createElement(\"span\", {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 11\n          }\n        }, row.creatorName));\n      } else if (header === \"viewCount\") {\n        return /*#__PURE__*/React.createElement(\"span\", {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 14\n          }\n        }, row.viewer);\n      } else if (header === \"status\") {\n        return /*#__PURE__*/React.createElement(Input, {\n          type: \"select\",\n          value: cell,\n          className: \"capitalize\",\n          onChange: function onChange(e) {\n            return _this._onUpdatePPVStatus(e, row);\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 9\n          }\n        }, _this.state.ppvStatusList.map(function (option, index) {\n          return /*#__PURE__*/React.createElement(\"option\", {\n            key: index,\n            value: option,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 13\n            }\n          }, option);\n        }));\n      } else if (header === \"fee\") {\n        console.log(row);\n        return /*#__PURE__*/React.createElement(\"p\", {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          title: \"Basic\",\n          style: {\n            textDecoration: \"none\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 11\n          }\n        }, row.basicPrice && Number.isInteger(row.basicPrice) ? \"$\" + row.basicPrice : row.basicPrice === 0 ? 0 : \"$\" + row.basicPrice.toFixed(2)), \"\\xA0 \\xA0\", /*#__PURE__*/React.createElement(\"span\", {\n          title: \"Plus\",\n          style: {\n            textDecoration: \"none\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 11\n          }\n        }, row.plusPrice && Number.isInteger(row.plusPrice) ? \"$\" + row.plusPrice : row.plusPrice === 0 ? 0 : \"$\" + row.plusPrice.toFixed(2)), \"\\xA0 \\xA0\", /*#__PURE__*/React.createElement(\"span\", {\n          title: \"Premium\",\n          style: {\n            textDecoration: \"none\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 11\n          }\n        }, row.premiumPrice && Number.isInteger(row.premiumPrice) ? \"$\" + row.premiumPrice : row.premiumPrice === 0 ? 0 : \"$\" + row.premiumPrice.toFixed(2)));\n      } else {\n        return cell;\n      }\n    };\n\n    _this._filterOnChange = function (_ref) {\n      var currentTarget = _ref.currentTarget;\n      var filters = _this.state.filters;\n\n      if (currentTarget.name === \"viewCount\") {\n        var breakviewCountNumber = currentTarget.value.split(\"-\");\n        filters[currentTarget.name].upper = breakviewCountNumber[1];\n        filters[currentTarget.name].lower = breakviewCountNumber[0];\n      } else {\n        filters[currentTarget.name] = currentTarget.value;\n      }\n\n      _this.setState({\n        filters: filters\n      }, function () {\n        console.log(\"filters :\", filters);\n      });\n\n      if (currentTarget.name !== \"search\") {\n        // this._filterTransactionList();\n        _this._applyFilterChanges();\n      }\n    };\n\n    _this._filterTransactionList = function () {\n      var filterConditions = []; // console.log(this.state);\n\n      var _this$state = _this.state,\n          filters = _this$state.filters,\n          transactionListBackup = _this$state.transactionListBackup,\n          transactionList = _this$state.transactionList;\n      Object.keys(filters).forEach(function (key) {\n        if (filters[key]) {\n          filterConditions.push(key);\n        }\n      }); // console.log(filterConditions);\n\n      transactionList = transactionListBackup;\n\n      if (filterConditions.length) {\n        if (filters.dateRange.startDate && filters.dateRange.endDate) {\n          transactionList = transactionList.filter(function (each) {\n            // console.log('====>>',filters.dateRange.startDate.toDate(), each.date, isAfter((filters.dateRange.startDate.toDate()), each.date))\n            // return (filters.dateRange.startDate.toDate()) >= new Date(each.date);\n            return moment(moment(each.date).format(\"YYYY-MM-DD\")).isBetween(filters.dateRange.startDate.format(\"YYYY-MM-DD\"), filters.dateRange.endDate.format(\"YYYY-MM-DD\"), null, \"[]\");\n          });\n        }\n\n        if (filters.type) {\n          transactionList = transactionList.filter(function (each) {\n            return each.name.toLowerCase() === filters.type.toLowerCase();\n          });\n        }\n\n        if (filters.subscriber) {\n          transactionList = transactionList.filter(function (each) {\n            return each.subscriber.id === filters.subscriber;\n          });\n        }\n\n        if (filters.creator) {\n          transactionList = transactionList.filter(function (each) {\n            return each.creator.id === filters.creator;\n          });\n        }\n\n        if (filters.status) {\n          transactionList = transactionList.filter(function (each) {\n            return each.status.toLowerCase() === filters.status.toLowerCase();\n          });\n        }\n\n        if (filters.search.trim().length) {\n          transactionList = transactionList.filter(function (each) {\n            return each.name.toLowerCase().includes(filters.search.toLowerCase()) || each.subscriberName.toLowerCase().includes(filters.search.toLowerCase()) || each.creatorName.toLowerCase().includes(filters.search.toLowerCase()) || each.status.toLowerCase().includes(filters.search.toLowerCase());\n          });\n        }\n\n        _this.setState({\n          transactionList: transactionList\n        });\n      } else {\n        _this.setState({\n          transactionList: transactionListBackup\n        });\n      }\n    };\n\n    _this._setSelectedRows = function (data) {\n      console.log(data);\n      var selectedPPVs = _this.state.selectedPPVs;\n      selectedPPVs = data;\n\n      _this.setState({\n        selectedPPVs: selectedPPVs\n      });\n    };\n\n    _this._onBulkStatusChange = function (_ref2) {\n      var currentTarget = _ref2.currentTarget;\n      var bulkStatus = _this.state.bulkStatus;\n      bulkStatus = currentTarget.value;\n\n      _this.setState({\n        bulkStatus: bulkStatus\n      });\n    };\n\n    _this._paginate = function (pageNumber, pageSize) {\n      console.log(\"pageNumber, pageSize :\", pageNumber, pageSize);\n      var tableConfig = _this.state.tableConfig;\n      tableConfig.pageNumber = pageNumber;\n      tableConfig.pageSize = pageSize;\n      tableConfig.loading = true;\n      setTimeout(function () {\n        _this.setState({\n          tableConfig: tableConfig\n        }, function () {\n          _this._getAllPPVs(_this.state.tableConfig);\n        });\n      }, 100);\n    };\n\n    _this._onSortChange = function (sortName, sortOrder) {\n      var _deepClone = deepClone(_this.state),\n          tableConfig = _deepClone.tableConfig;\n\n      tableConfig.sort.sortBy = _this.state.ppvFieldsKeyMap[sortName];\n      tableConfig.sort.sortOrder = sortOrder;\n      tableConfig.loading = true;\n\n      _this.setState({\n        tableConfig: tableConfig\n      }, function () {\n        _this._getAllPPVs(tableConfig);\n      });\n\n      console.log(\"sortName, sortOrder :\", sortName, sortOrder);\n    };\n\n    _this._applyFilterChanges = function () {\n      var _deepClone2 = deepClone(_this.state),\n          filters = _deepClone2.filters,\n          tableConfig = _deepClone2.tableConfig;\n\n      console.log(\"filters :\", filters);\n      var data = {\n        viewCount: {}\n      };\n\n      if (filters.viewCount.upper || filters.viewCount.lower) {\n        data.viewCount.upper = filters.viewCount.upper;\n        data.viewCount.lower = filters.viewCount.lower;\n      }\n\n      if (filters.creator.length) {\n        data._influencer = filters.creator;\n      }\n\n      if (filters.status.length) {\n        data.status = filters.status;\n      }\n\n      if (filters.dateRange.startDate && filters.dateRange.endDate) {\n        data.start = filters.dateRange.startDate.toISOString();\n        data.end = filters.dateRange.endDate.toISOString();\n      }\n\n      console.log(\"data :\", data);\n      tableConfig.filters = data;\n\n      if (filters.search.length) {\n        tableConfig.search = filters.search;\n      } else {\n        tableConfig.search = \"\";\n      }\n\n      tableConfig.loading = true;\n\n      _this.setState({\n        tableConfig: tableConfig\n      }, function () {\n        _this._getAllPPVs(tableConfig);\n      });\n    };\n\n    _this._sendMessage = function () {\n      var _this$state2 = _this.state,\n          contact = _this$state2.contact,\n          selectedPPVs = _this$state2.selectedPPVs;\n      var data = {\n        idlist: selectedPPVs,\n        text: contact.via === \"email\" ? contact.message : _this._extractContent(contact.message)\n      };\n\n      if (data.idlist && !data.idlist.length) {\n        ToastsStore.warning(\"Please select atleast one creator\", 3000);\n        return;\n      }\n\n      if (!data.text.trim().length) {\n        ToastsStore.warning(\"Please write some message\", 3000);\n        return;\n      }\n\n      console.log(data);\n\n      _this._manageLoading(\"send-message\", true);\n\n      sendMessage(contact.via, data).then(function (response) {\n        console.log(response);\n\n        _this._setMessageContent(\"\", \"message\");\n\n        _this._manageLoading(\"send-message\", false);\n\n        ToastsStore.success(\"Message sent Successfully!\", 3000);\n      }, function (error) {\n        console.log(error);\n\n        _this._manageLoading(\"send-message\", false); // ToastsStore.error(error.reason, 3000);\n\n\n        showToast(error.reason && error.reason.length ? error.reason : \"Server error. Try again after sometime.\", \"error\");\n      });\n    };\n\n    _this._contactOnChange = function (_ref3) {\n      var currentTarget = _ref3.currentTarget;\n      var contact = _this.state.contact;\n      contact[currentTarget.name] = currentTarget.value;\n\n      _this.setState({\n        contact: contact\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(PayPerView, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._getAllUsers();\n\n      this._getAllPPVs(this.state.tableConfig);\n    }\n  }, {\n    key: \"_formatDate\",\n    value: function _formatDate(date, dateFormat) {\n      return format(new Date(date), dateFormat);\n    }\n  }, {\n    key: \"_onUpdatePPVStatus\",\n    value: function _onUpdatePPVStatus(_ref4, data) {\n      var _this2 = this;\n\n      var currentTarget = _ref4.currentTarget;\n\n      var _deepClone3 = deepClone(this.state),\n          ppvList = _deepClone3.ppvList;\n\n      var ppv = ppvList.find(function (each, index) {\n        return each.id === data.id;\n      });\n      ppv.status = currentTarget.value;\n      var dataToUpdate = {\n        id: data.id,\n        status: ppv.status\n      };\n      console.log(dataToUpdate);\n      this.setState({\n        ppvList: ppvList,\n        ppvListBackup: ppvList\n      });\n      onUpdatePPVStatus(dataToUpdate).then(function (response) {\n        console.log(response);\n        ToastsStore.success(\"Status changed Successfully!\", 3000);\n      }, function (error) {\n        console.log(error); // ToastsStore.error(error.reason, 3000);\n\n        _this2._getAllPPVs();\n\n        showToast(error.reason && error.reason.length ? error.reason : \"Server error. Try again after sometime.\", \"error\");\n      });\n    }\n  }, {\n    key: \"_extractContent\",\n    value: function _extractContent(s) {\n      var span = document.createElement(\"span\");\n      span.innerHTML = s;\n      return span.textContent || span.innerText;\n    }\n  }, {\n    key: \"_setMessageContent\",\n    value: function _setMessageContent(value, key) {\n      var contact = this.state.contact;\n      contact[key] = value;\n      this.setState({\n        contact: contact\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state3 = this.state,\n          filters = _this$state3.filters,\n          loading = _this$state3.loading,\n          creatorList = _this$state3.creatorList,\n          contact = _this$state3.contact,\n          totalCount = _this$state3.totalCount,\n          tableConfig = _this$state3.tableConfig,\n          ppvStatusList = _this$state3.ppvStatusList;\n      console.log(loading);\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"app TruFansPgBg animated fadeIn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Container, {\n        fluid: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        xs: \"12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 581,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"PgTitle justify-content-start align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 583,\n          columnNumber: 17\n        }\n      }, \"Sales\")), !loading.loadingData && /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 587,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"filterWrap filterWrap-TransactionsPg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fa fa-filter\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 23\n        }\n      }), /*#__PURE__*/React.createElement(Input, {\n        type: \"select\",\n        name: \"creator\",\n        value: filters.creator,\n        onChange: this._filterOnChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 591,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 597,\n          columnNumber: 25\n        }\n      }, \"Category\"), creatorList.map(function (option) {\n        return /*#__PURE__*/React.createElement(\"option\", {\n          key: option.id,\n          value: option.id,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 27\n          }\n        }, option.name);\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ml-2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(CustomDateRangePicker, {\n        dateRange: filters.dateRange,\n        onDatesChange: this._onDatesChange,\n        onFocusChange: this._onFocusChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 605,\n          columnNumber: 25\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center mt-md-3 mt-xl-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 643,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        type: \"text\",\n        id: \"search\",\n        placeholder: \"Search\",\n        className: \"ml-2\",\n        name: \"search\",\n        autoComplete: \"off\",\n        value: filters.search,\n        onChange: this._filterOnChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 644,\n          columnNumber: 23\n        }\n      }), /*#__PURE__*/React.createElement(Button, {\n        color: \"secondary\",\n        className: \"ml-2\",\n        onClick: function onClick() {\n          return _this3._applyFilterChanges();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"icon-magnifier\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 660,\n          columnNumber: 25\n        }\n      })))), \" \", /*#__PURE__*/React.createElement(CustomDataTable, {\n        tableData: this.state.ppvList,\n        headerKeys: this.state.headerKeys,\n        dataFormat: this._dataFormat,\n        totalCount: totalCount,\n        rowSelection: true,\n        onPaginate: function onPaginate(pageNumber, pageSize) {\n          return _this3._paginate(pageNumber, pageSize);\n        },\n        onSortChange: function onSortChange(sortName, sortOrder) {\n          return _this3._onSortChange(sortName, sortOrder);\n        },\n        setSelectedRows: function setSelectedRows(data) {\n          return _this3._setSelectedRows(data);\n        },\n        showTableLoading: tableConfig.loading,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 664,\n          columnNumber: 19\n        }\n      })), loading.loadingData && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"filterWrap\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 682,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loading-section list-loading\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 683,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fa fa-spinner fa-spin\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 684,\n          columnNumber: 21\n        }\n      }), \" \\xA0 Loading Pay per view..\")))), /*#__PURE__*/React.createElement(Row, {\n        className: \"justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 693,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        md: \"12\",\n        lg: \"12\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 694,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex my-5 flex-column w-75 mx-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 695,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex justify-content-between\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 696,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 697,\n          columnNumber: 19\n        }\n      }, \"Send Reminder\"), /*#__PURE__*/React.createElement(Input, {\n        type: \"select\",\n        style: {\n          width: \"175px\",\n          marginLeft: \"40px\",\n          marginRight: \"40px\"\n        },\n        name: \"via\",\n        value: contact.via,\n        onChange: this._contactOnChange,\n        className: \"capitalize\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 698,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"email\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 710,\n          columnNumber: 21\n        }\n      }, \"Email\"), /*#__PURE__*/React.createElement(\"option\", {\n        value: \"push\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 711,\n          columnNumber: 21\n        }\n      }, \"Push\")), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          flex: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 714,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(TextEditor, {\n        content: contact.message,\n        onChange: function onChange(e) {\n          return _this3._setMessageContent(e, \"message\");\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 715,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(Button, {\n        className: \"BtnPurple mt-4 d-block mx-auto\",\n        style: {\n          padding: \"8px 25px\"\n        },\n        disabled: loading.sendingMessage,\n        onClick: this._sendMessage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 720,\n          columnNumber: 21\n        }\n      }, loading.sendingMessage ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fa fa-spinner fa-spin mr5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 728,\n          columnNumber: 27\n        }\n      }), \"\\xA0\") : null, \"Send\"))))))));\n    }\n  }]);\n\n  return PayPerView;\n}(Component);\n\nexport default PayPerView;","map":{"version":3,"sources":["/home/sanjay/Desktop/LS/React/Socialaffil-admin-UI/src/pages/sales.js"],"names":["React","Component","Container","Row","Col","Button","Input","Link","CustomTable","CustomDateRangePicker","getAllUsers","getAllPPVs","onUpdatePPVStatus","sendMessage","ToastsStore","config","format","TextEditor","moment","showToast","deepClone","CustomDataTable","PayPerView","state","ppvList","orderid","product","price","salesamount","created","status","ppvListBackup","creatorList","subscriberList","transactionList","transactionListBackup","paymentTypes","ppvStatusList","headerKeys","id","label","filters","dateRange","startDate","endDate","focusedInput","startDateId","endDateId","viewCount","upper","lower","subscriber","creator","search","loading","loadingData","changeStatusLoading","tableLoading","sendingMessage","contact","via","message","selectedPPVs","bulkStatus","selectedTransactions","totalCount","ppvFieldsKeyMap","name","fee","date","creatorName","tableConfig","pageNumber","pageSize","sort","sortBy","sortOrder","_getAllPPVs","data","console","log","then","response","_manageLoading","setState","ppvListResp","payperviews","map","each","title","_influencer","full","_id","flag","address","country","creatorId","profilePicture","defaultUserPicture","time","scheduledAt","createdAt","viewer","basicPrice","premiumPrice","plusPrice","count","catch","err","_onDatesChange","_applyFilterChanges","_onFocusChange","input","key","value","_getAllUsers","influencers","a","b","textA","toLowerCase","textB","fans","error","reason","length","_dataFormat","cell","row","header","toFixed","e","_onUpdatePPVStatus","option","index","textDecoration","Number","isInteger","_filterOnChange","currentTarget","breakviewCountNumber","split","_filterTransactionList","filterConditions","Object","keys","forEach","push","filter","isBetween","type","trim","includes","subscriberName","_setSelectedRows","_onBulkStatusChange","_paginate","setTimeout","_onSortChange","sortName","start","toISOString","end","_sendMessage","idlist","text","_extractContent","warning","_setMessageContent","success","_contactOnChange","dateFormat","Date","ppv","find","dataToUpdate","s","span","document","createElement","innerHTML","textContent","innerText","width","marginLeft","marginRight","flex","padding"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {\n  Container,\n  Row,\n  Col,\n  // Table,\n  Button,\n  Input,\n  // FormGroup,\n  // Label\n} from \"reactstrap\";\nimport { Link } from \"react-router-dom\";\nimport CustomTable from \"../components/custom-table\";\nimport CustomDateRangePicker from \"../components/date-range-picker\";\nimport {\n  // getAllCreators,\n  // getAllSubscribers,\n  // getAllTransactions,\n  // updateTransactions,\n  getAllUsers,\n  getAllPPVs,\n  onUpdatePPVStatus,\n  sendMessage,\n} from \"../http/http-calls\";\nimport { ToastsStore } from \"react-toasts\";\nimport config from \"../config\";\nimport { format } from \"date-fns\";\nimport TextEditor from \"../components/text-editor\";\nimport moment from \"moment\";\nimport { showToast, deepClone } from \"../helper-methods\";\nimport CustomDataTable from \"../components/custom-data-table\";\n\nclass PayPerView extends Component {\n  state = {\n    ppvList: [\n      {\n        orderid: \"\",\n        product: \"\",\n        price: 123,\n        salesamount: \"\",\n        created: \"\",\n        status: \"\",\n      },\n    ],\n    ppvListBackup: [],\n    creatorList: [],\n    subscriberList: [],\n    transactionList: [],\n    transactionListBackup: [],\n    paymentTypes: config.paymentTypes,\n    ppvStatusList: [\"published\", \"archived\", \"scheduled\"],\n    headerKeys: [\n      { id: \"id\", label: \"id\" },\n      { id: \"orderid\", label: \"Order Id\" },\n      { id: \"product\", label: \"Product\" },\n      { id: \"price\", label: \"Price\" },\n      // { id: \"sales\", label: \"Sales\" },\n      { id: \"salesamount\", label: \"Sales Amount\" },\n      { id: \"created\", label: \"Created\" },\n      { id: \"status\", label: \"Status\" },\n    ],\n    filters: {\n      dateRange: {\n        startDate: null,\n        endDate: null,\n        focusedInput: null,\n        startDateId: \"startDate\",\n        endDateId: \"endDate\",\n      },\n      viewCount: {\n        upper: \"\",\n        lower: \"\",\n      },\n      subscriber: \"\",\n      creator: \"\",\n      status: \"\",\n      search: \"\",\n    },\n    loading: {\n      loadingData: true,\n      changeStatusLoading: false,\n      tableLoading: false,\n      sendingMessage: false,\n    },\n    contact: {\n      via: \"email\",\n      message: \"\",\n    },\n    selectedPPVs: [],\n    bulkStatus: \"\",\n    selectedTransactions: [],\n    totalCount: 0,\n    ppvFieldsKeyMap: {\n      name: \"ppv\",\n      fee: \"price\",\n      date: \"time\",\n      viewCount: \"viewCount\",\n      creatorName: \"_influencer\",\n      status: \"status\",\n    },\n    tableConfig: {\n      pageNumber: 1,\n      pageSize: 10,\n      sort: {\n        sortBy: \"time\",\n        sortOrder: \"desc\",\n      },\n      filters: {},\n    },\n  };\n\n  componentDidMount() {\n    this._getAllUsers();\n    this._getAllPPVs(this.state.tableConfig);\n  }\n\n  _getAllPPVs = (data) => {\n    const { tableConfig } = this.state;\n    console.log(\"LiveEvents -> _getLiveEvents -> tableConfig\", data);\n    getAllPPVs(data)\n      .then((response) => {\n        this._manageLoading(\"data\", false);\n        tableConfig.loading = false;\n        this.setState({ tableConfig });\n        console.log(\"response >>\", response);\n        let ppvListResp = response.payperviews.map((each) => {\n          return {\n            name: each.title,\n            creatorName: each._influencer.name.full,\n            id: each._id,\n            flag: each._influencer.address.country,\n            creatorId: each._influencer._id,\n            profilePicture:\n              each._influencer.profilePicture || config.defaultUserPicture,\n\n            time: moment(each.scheduledAt).format(\"LLL\"),\n\n            status: each.status,\n\n            createdAt: each.createdAt,\n            viewer: each.viewCount ? each.viewCount : 0,\n            basicPrice: each.price ? each.price : 0,\n            premiumPrice: each.premiumPrice ? each.premiumPrice : 0,\n            plusPrice: each.plusPrice ? each.plusPrice : 0,\n          };\n        });\n        this.setState({\n          // ppvList: ppvListResp,\n          ppvListBackup: ppvListResp,\n          totalCount: response.count,\n        });\n      })\n      .catch((err) => {});\n  };\n\n  _formatDate(date, dateFormat) {\n    return format(new Date(date), dateFormat);\n  }\n\n  _onDatesChange = (startDate, endDate) => {\n    // console.log(\"on date change\", startDate, endDate);\n    let { filters } = this.state;\n    filters.dateRange.startDate = startDate;\n    filters.dateRange.endDate = endDate;\n    this.setState({ filters });\n    if (filters.dateRange.startDate && filters.dateRange.endDate) {\n      // console.log(\"range selction complete\");\n      // this._filterTransactionList();\n      this._applyFilterChanges();\n    }\n  };\n\n  _onFocusChange = (input) => {\n    // console.log(input);\n    let { filters } = this.state;\n    filters.dateRange.focusedInput = input;\n    this.setState({ filters });\n  };\n\n  _manageLoading = (key, value) => {\n    let {\n      loadingData,\n      changeStatusLoading,\n      tableLoading,\n      sendingMessage,\n    } = this.state.loading;\n    if (key === \"data\") {\n      loadingData = value;\n    } else if (key === \"change-status\") {\n      changeStatusLoading = value;\n    } else if (key === \"table\") {\n      tableLoading = value;\n    } else if (key === \"send-message\") {\n      sendingMessage = value;\n    }\n    this.setState({\n      loading: { loadingData, changeStatusLoading, tableLoading },\n    });\n  };\n\n  _getAllUsers = () => {\n    getAllUsers().then(\n      (response) => {\n        console.log(\"response :\", response);\n        let creatorList = response.influencers.map((each) => {\n          return {\n            name: each.name.full,\n            id: each.id,\n          };\n        });\n        creatorList = creatorList.sort(function (a, b) {\n          let textA = a.name.toLowerCase();\n          let textB = b.name.toLowerCase();\n          return textA < textB ? -1 : textA > textB ? 1 : 0;\n        });\n        let subscriberList = response.fans.map((each) => {\n          return {\n            name: each.name.full,\n            id: each.id,\n          };\n        });\n        subscriberList = subscriberList.sort(function (a, b) {\n          let textA = a.name.toLowerCase();\n          let textB = b.name.toLowerCase();\n          return textA < textB ? -1 : textA > textB ? 1 : 0;\n        });\n        this.setState({ creatorList, subscriberList });\n      },\n      (error) => {\n        console.log(\"error :\", error);\n        showToast(\n          error.reason && error.reason.length\n            ? error.reason\n            : \"Server error. Try again after sometime.\",\n          \"error\"\n        );\n      }\n    );\n  };\n\n  _dataFormat = (cell, row, header) => {\n    // console.log(\"_dataFormat -> row\", row);\n    // console.log(\"header\", header);\n    // console.log(cell, row, header);_formatDate\n    if (header === \"name\") {\n      return (\n        <Link to={`/pay-per-view/${row.id}`}>\n          <span className=\"capitalize\">{row.name}</span>\n        </Link>\n      );\n    } else if (header === \"amount\") {\n      return typeof cell === \"number\" ? \"$\" + cell.toFixed(2) : \"-\";\n    } else if (header === \"date\") {\n      return <>{row.time}</>;\n    } else if (header === \"creatorName\") {\n      return (\n        <Link to={`/creator-view/${row.creatorId}`}>\n          <img\n            src={`https://www.countryflags.io/${row.flag}/flat/24.png`}\n            alt=\"flag\"\n            className=\"mr-2\"\n          />\n          <span>{row.creatorName}</span>\n        </Link>\n      );\n    } else if (header === \"viewCount\") {\n      return <span>{row.viewer}</span>;\n    } else if (header === \"status\") {\n      return (\n        <Input\n          type=\"select\"\n          value={cell}\n          className=\"capitalize\"\n          onChange={(e) => this._onUpdatePPVStatus(e, row)}\n        >\n          {this.state.ppvStatusList.map((option, index) => (\n            <option key={index} value={option}>\n              {option}\n            </option>\n          ))}\n        </Input>\n      );\n    } else if (header === \"fee\") {\n      console.log(row);\n      return (\n        <p>\n          <span title=\"Basic\" style={{ textDecoration: \"none\" }}>\n            {row.basicPrice && Number.isInteger(row.basicPrice)\n              ? \"$\" + row.basicPrice\n              : row.basicPrice === 0\n              ? 0\n              : \"$\" + row.basicPrice.toFixed(2)}\n          </span>\n          &nbsp; &nbsp;\n          <span title=\"Plus\" style={{ textDecoration: \"none\" }}>\n            {row.plusPrice && Number.isInteger(row.plusPrice)\n              ? \"$\" + row.plusPrice\n              : row.plusPrice === 0\n              ? 0\n              : \"$\" + row.plusPrice.toFixed(2)}\n          </span>\n          &nbsp; &nbsp;\n          <span title=\"Premium\" style={{ textDecoration: \"none\" }}>\n            {row.premiumPrice && Number.isInteger(row.premiumPrice)\n              ? \"$\" + row.premiumPrice\n              : row.premiumPrice === 0\n              ? 0\n              : \"$\" + row.premiumPrice.toFixed(2)}\n          </span>\n        </p>\n      );\n    } else {\n      return cell;\n    }\n  };\n\n  _onUpdatePPVStatus({ currentTarget }, data) {\n    let { ppvList } = deepClone(this.state);\n    let ppv = ppvList.find((each, index) => each.id === data.id);\n    ppv.status = currentTarget.value;\n    let dataToUpdate = {\n      id: data.id,\n      status: ppv.status,\n    };\n    console.log(dataToUpdate);\n    this.setState({\n      ppvList,\n      ppvListBackup: ppvList,\n    });\n    onUpdatePPVStatus(dataToUpdate).then(\n      (response) => {\n        console.log(response);\n        ToastsStore.success(\"Status changed Successfully!\", 3000);\n      },\n      (error) => {\n        console.log(error);\n        // ToastsStore.error(error.reason, 3000);\n        this._getAllPPVs();\n        showToast(\n          error.reason && error.reason.length\n            ? error.reason\n            : \"Server error. Try again after sometime.\",\n          \"error\"\n        );\n      }\n    );\n  }\n\n  _filterOnChange = ({ currentTarget }) => {\n    let { filters } = this.state;\n\n    if (currentTarget.name === \"viewCount\") {\n      let breakviewCountNumber = currentTarget.value.split(\"-\");\n      filters[currentTarget.name].upper = breakviewCountNumber[1];\n      filters[currentTarget.name].lower = breakviewCountNumber[0];\n    } else {\n      filters[currentTarget.name] = currentTarget.value;\n    }\n\n    this.setState({ filters }, () => {\n      console.log(\"filters :\", filters);\n    });\n    if (currentTarget.name !== \"search\") {\n      // this._filterTransactionList();\n      this._applyFilterChanges();\n    }\n  };\n\n  // old function for frontend filtering - not using now\n  _filterTransactionList = () => {\n    let filterConditions = [];\n    // console.log(this.state);\n    let { filters, transactionListBackup, transactionList } = this.state;\n    Object.keys(filters).forEach((key) => {\n      if (filters[key]) {\n        filterConditions.push(key);\n      }\n    });\n    // console.log(filterConditions);\n    transactionList = transactionListBackup;\n    if (filterConditions.length) {\n      if (filters.dateRange.startDate && filters.dateRange.endDate) {\n        transactionList = transactionList.filter((each) => {\n          // console.log('====>>',filters.dateRange.startDate.toDate(), each.date, isAfter((filters.dateRange.startDate.toDate()), each.date))\n          // return (filters.dateRange.startDate.toDate()) >= new Date(each.date);\n          return moment(moment(each.date).format(\"YYYY-MM-DD\")).isBetween(\n            filters.dateRange.startDate.format(\"YYYY-MM-DD\"),\n            filters.dateRange.endDate.format(\"YYYY-MM-DD\"),\n            null,\n            \"[]\"\n          );\n        });\n      }\n      if (filters.type) {\n        transactionList = transactionList.filter((each) => {\n          return each.name.toLowerCase() === filters.type.toLowerCase();\n        });\n      }\n      if (filters.subscriber) {\n        transactionList = transactionList.filter((each) => {\n          return each.subscriber.id === filters.subscriber;\n        });\n      }\n      if (filters.creator) {\n        transactionList = transactionList.filter((each) => {\n          return each.creator.id === filters.creator;\n        });\n      }\n      if (filters.status) {\n        transactionList = transactionList.filter((each) => {\n          return each.status.toLowerCase() === filters.status.toLowerCase();\n        });\n      }\n      if (filters.search.trim().length) {\n        transactionList = transactionList.filter((each) => {\n          return (\n            each.name.toLowerCase().includes(filters.search.toLowerCase()) ||\n            each.subscriberName\n              .toLowerCase()\n              .includes(filters.search.toLowerCase()) ||\n            each.creatorName\n              .toLowerCase()\n              .includes(filters.search.toLowerCase()) ||\n            each.status.toLowerCase().includes(filters.search.toLowerCase())\n          );\n        });\n      }\n      this.setState({ transactionList });\n    } else {\n      this.setState({ transactionList: transactionListBackup });\n    }\n  };\n\n  _setSelectedRows = (data) => {\n    console.log(data);\n    let { selectedPPVs } = this.state;\n    selectedPPVs = data;\n    this.setState({ selectedPPVs });\n  };\n\n  _onBulkStatusChange = ({ currentTarget }) => {\n    let { bulkStatus } = this.state;\n    bulkStatus = currentTarget.value;\n    this.setState({ bulkStatus });\n  };\n\n  _paginate = (pageNumber, pageSize) => {\n    console.log(\"pageNumber, pageSize :\", pageNumber, pageSize);\n    const { tableConfig } = this.state;\n    tableConfig.pageNumber = pageNumber;\n    tableConfig.pageSize = pageSize;\n    tableConfig.loading = true;\n    setTimeout(() => {\n      this.setState({ tableConfig }, () => {\n        this._getAllPPVs(this.state.tableConfig);\n      });\n    }, 100);\n  };\n\n  _onSortChange = (sortName, sortOrder) => {\n    const { tableConfig } = deepClone(this.state);\n    tableConfig.sort.sortBy = this.state.ppvFieldsKeyMap[sortName];\n    tableConfig.sort.sortOrder = sortOrder;\n    tableConfig.loading = true;\n    this.setState({ tableConfig }, () => {\n      this._getAllPPVs(tableConfig);\n    });\n    console.log(\"sortName, sortOrder :\", sortName, sortOrder);\n  };\n\n  _applyFilterChanges = () => {\n    const { filters, tableConfig } = deepClone(this.state);\n    console.log(\"filters :\", filters);\n    let data = {\n      viewCount: {},\n    };\n\n    if (filters.viewCount.upper || filters.viewCount.lower) {\n      data.viewCount.upper = filters.viewCount.upper;\n      data.viewCount.lower = filters.viewCount.lower;\n    }\n\n    if (filters.creator.length) {\n      data._influencer = filters.creator;\n    }\n    if (filters.status.length) {\n      data.status = filters.status;\n    }\n    if (filters.dateRange.startDate && filters.dateRange.endDate) {\n      data.start = filters.dateRange.startDate.toISOString();\n      data.end = filters.dateRange.endDate.toISOString();\n    }\n    console.log(\"data :\", data);\n    tableConfig.filters = data;\n    if (filters.search.length) {\n      tableConfig.search = filters.search;\n    } else {\n      tableConfig.search = \"\";\n    }\n    tableConfig.loading = true;\n    this.setState({ tableConfig }, () => {\n      this._getAllPPVs(tableConfig);\n    });\n  };\n\n  _extractContent(s) {\n    var span = document.createElement(\"span\");\n    span.innerHTML = s;\n    return span.textContent || span.innerText;\n  }\n\n  _setMessageContent(value, key) {\n    let { contact } = this.state;\n    contact[key] = value;\n    this.setState({ contact });\n  }\n\n  _sendMessage = () => {\n    let { contact, selectedPPVs } = this.state;\n    let data = {\n      idlist: selectedPPVs,\n      text:\n        contact.via === \"email\"\n          ? contact.message\n          : this._extractContent(contact.message),\n    };\n    if (data.idlist && !data.idlist.length) {\n      ToastsStore.warning(\"Please select atleast one creator\", 3000);\n      return;\n    }\n    if (!data.text.trim().length) {\n      ToastsStore.warning(\"Please write some message\", 3000);\n      return;\n    }\n    console.log(data);\n    this._manageLoading(\"send-message\", true);\n    sendMessage(contact.via, data).then(\n      (response) => {\n        console.log(response);\n        this._setMessageContent(\"\", \"message\");\n        this._manageLoading(\"send-message\", false);\n        ToastsStore.success(\"Message sent Successfully!\", 3000);\n      },\n      (error) => {\n        console.log(error);\n        this._manageLoading(\"send-message\", false);\n        // ToastsStore.error(error.reason, 3000);\n        showToast(\n          error.reason && error.reason.length\n            ? error.reason\n            : \"Server error. Try again after sometime.\",\n          \"error\"\n        );\n      }\n    );\n  };\n\n  _contactOnChange = ({ currentTarget }) => {\n    let { contact } = this.state;\n    contact[currentTarget.name] = currentTarget.value;\n    this.setState({ contact });\n  };\n\n  render() {\n    const {\n      filters,\n      loading,\n      creatorList,\n      contact,\n      totalCount,\n      tableConfig,\n      ppvStatusList,\n    } = this.state;\n\n    console.log(loading);\n\n    return (\n      <div className=\"app TruFansPgBg animated fadeIn\">\n        <Container fluid>\n          <Row>\n            <Col xs=\"12\">\n              <div className=\"PgTitle justify-content-start align-items-center\">\n                <h2>Sales</h2>\n              </div>\n              {/* filters */}\n              {!loading.loadingData && (\n                <div>\n                  <div className=\"filterWrap filterWrap-TransactionsPg\">\n                    <div className=\"d-flex align-items-center\">\n                      <i className=\"fa fa-filter\"></i>\n                      <Input\n                        type=\"select\"\n                        name=\"creator\"\n                        value={filters.creator}\n                        onChange={this._filterOnChange}\n                      >\n                        <option value=\"\">Category</option>\n                        {creatorList.map((option) => (\n                          <option key={option.id} value={option.id}>\n                            {option.name}\n                          </option>\n                        ))}\n                      </Input>\n                      <div className=\"ml-2\">\n                        <CustomDateRangePicker\n                          dateRange={filters.dateRange}\n                          onDatesChange={this._onDatesChange}\n                          onFocusChange={this._onFocusChange}\n                        ></CustomDateRangePicker>\n                      </div>\n                      {/* \n                      <Input\n                        type=\"select\"\n                        name=\"status\"\n                        value={filters.status}\n                        onChange={this._filterOnChange}\n                        className=\"capitalize\"\n                      >\n                        <option value=\"\">Status</option>\n                        {ppvStatusList.map((option) => (\n                          <option key={option} value={option}>\n                            {option}\n                          </option>\n                        ))}\n                      </Input> */}\n                      {/* <Input\n                        type=\"select\"\n                        name=\"viewCount\"\n                        value={filters.viewCountNumber}\n                        onChange={this._filterOnChange}\n                        className=\"capitalize\"\n                      >\n                        <option value=\"\">Viewers</option>\n                        <option value=\"0-0\">0</option>\n                        <option value=\"1-10\">1 - 10</option>\n                        <option value=\"11-50\">11 - 50</option>\n                        <option value=\"51-100\">51 - 200</option>\n                        <option value=\"201-500\">201 - 500</option>\n                        <option value=\"0-500\">500+</option>\n                      </Input> */}\n                    </div>\n\n                    <div className=\"d-flex align-items-center mt-md-3 mt-xl-0\">\n                      <Input\n                        type=\"text\"\n                        id=\"search\"\n                        placeholder=\"Search\"\n                        className=\"ml-2\"\n                        name=\"search\"\n                        autoComplete=\"off\"\n                        value={filters.search}\n                        onChange={this._filterOnChange}\n                      />\n\n                      <Button\n                        color=\"secondary\"\n                        className=\"ml-2\"\n                        onClick={() => this._applyFilterChanges()}\n                      >\n                        <i className=\"icon-magnifier\"></i>\n                      </Button>\n                    </div>\n                  </div>{\" \"}\n                  <CustomDataTable\n                    tableData={this.state.ppvList}\n                    headerKeys={this.state.headerKeys}\n                    dataFormat={this._dataFormat}\n                    totalCount={totalCount}\n                    rowSelection={true}\n                    onPaginate={(pageNumber, pageSize) =>\n                      this._paginate(pageNumber, pageSize)\n                    }\n                    onSortChange={(sortName, sortOrder) =>\n                      this._onSortChange(sortName, sortOrder)\n                    }\n                    setSelectedRows={(data) => this._setSelectedRows(data)}\n                    showTableLoading={tableConfig.loading}\n                  ></CustomDataTable>\n                </div>\n              )}\n              {loading.loadingData && (\n                <div className=\"filterWrap\">\n                  <div className=\"loading-section list-loading\">\n                    <i className=\"fa fa-spinner fa-spin\"></i> &nbsp; Loading Pay\n                    per view..\n                  </div>\n                </div>\n              )}\n            </Col>\n          </Row>\n\n          {/* The below \"Row\" will appear after the user selects row(s) from the above table */}\n          <Row className=\"justify-content-center\">\n            <Col md=\"12\" lg=\"12\">\n              <div className=\"d-flex my-5 flex-column w-75 mx-auto\">\n                <div className=\"d-flex justify-content-between\">\n                  <p>Send Reminder</p>\n                  <Input\n                    type=\"select\"\n                    style={{\n                      width: \"175px\",\n                      marginLeft: \"40px\",\n                      marginRight: \"40px\",\n                    }}\n                    name=\"via\"\n                    value={contact.via}\n                    onChange={this._contactOnChange}\n                    className=\"capitalize\"\n                  >\n                    <option value=\"email\">Email</option>\n                    <option value=\"push\">Push</option>\n                  </Input>\n\n                  <div style={{ flex: 1 }}>\n                    <TextEditor\n                      content={contact.message}\n                      onChange={(e) => this._setMessageContent(e, \"message\")}\n                    ></TextEditor>\n\n                    <Button\n                      className=\"BtnPurple mt-4 d-block mx-auto\"\n                      style={{ padding: \"8px 25px\" }}\n                      disabled={loading.sendingMessage}\n                      onClick={this._sendMessage}\n                    >\n                      {loading.sendingMessage ? (\n                        <>\n                          <i className=\"fa fa-spinner fa-spin mr5\" />\n                          &nbsp;\n                        </>\n                      ) : null}\n                      Send\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </Col>\n          </Row>\n        </Container>\n      </div>\n    );\n  }\n}\n\nexport default PayPerView;\n"]},"metadata":{},"sourceType":"module"}